<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Results | Eliana Trust School</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f4f6f9;margin:0}
header,footer{background:#0b5ed7;color:#fff;text-align:center;padding:15px}
nav a{color:#fff;margin:0 8px;text-decoration:none}

.form-section{
  max-width:900px;margin:40px auto;background:#fff;
  padding:25px;border-radius:10px
}
input,select{
  width:100%;padding:10px;margin:10px 0;
  border-radius:6px;border:1px solid #ccc
}
.btn{
  background:#0b5ed7;color:#fff;
  padding:10px 18px;border:none;
  border-radius:6px;cursor:pointer
}
.btn.secondary{background:#198754}

table{
  width:100%;border-collapse:collapse;margin-top:15px
}
th,td{border:1px solid #000;padding:8px;text-align:center}
th{background:#0b5ed7;color:#fff}

/* PRINT MODE */
@media print{
  body{background:#fff}
  header,nav,.btn,.form-section form{display:none}
  footer{position:fixed;bottom:0;width:100%}
}
</style>
</head>

<body>

<header>
<h1>ELIANA TRUST SCHOOL</h1>
<nav>
  <a href="index.html">Home</a>
  <a href="results.html" class="active">Results</a>
</nav>
</header>

<section class="form-section">
<h2>Check Results</h2>

<form id="resultForm">
  <input id="admissionNo" placeholder="Admission Number" required>

  <select id="term" required>
    <option value="">Select Term</option>
    <option>Term 1</option>
    <option>Term 2</option>
    <option>Term 3</option>
  </select>

  <select id="year" required>
    <option value="">Select Year</option>
    <option>2026</option>
    <option>2027</option>
  </select>

  <button class="btn">View Results</button>
</form>

<div id="resultOutput"></div>
</section>

<footer>
<p>&copy; 2026 Eliana Trust School</p>
</footer>

<script>
const SHEET =
"https://opensheet.elk.sh/16jBJP4DgQrnHwKCr_ptA0xWYk3YIwRlDp0o5Q2WsriU/Eresults";

const grade=s=>s>=75?'A':s>=60?'B':s>=50?'C':s>=40?'D':'F';
const remark=s=>s>=75?'Excellent':s>=60?'Very Good':s>=50?'Good':s>=40?'Fair':'Fail';

document.getElementById("resultForm").onsubmit=e=>{
  e.preventDefault();

  const adm=admissionNo.value.trim();
  const term=document.getElementById("term").value.toLowerCase();
  const year=document.getElementById("year").value.toLowerCase();
  const out=resultOutput;

  out.innerHTML="Loading...";

  fetch(SHEET).then(r=>r.json()).then(data=>{
    const student=data.filter(r=>String(r.AdmissionNo).trim()===adm);
    if(!student.length){
      out.innerHTML="❌ Candidate not found";
      return;
    }

    const res=student.filter(r=>
      r.term.toLowerCase()===term &&
      r.year.toLowerCase()===year
    );

    if(!res.length){
      out.innerHTML="⚠ Results not available for selected term/year";
      return;
    }

    let rows="";
    res.forEach(r=>{
      rows+=`
      <tr>
        <td>${r.Subject}</td>
        <td>${r.Score}</td>
        <td>${grade(r.Score)}</td>
        <td>${remark(r.Score)}</td>
      </tr>`;
    });

    out.innerHTML=`
    <div>
      <h2 style="text-align:center">ELIANA TRUST SCHOOL</h2>
      <p style="text-align:center"><b>${term.toUpperCase()} ${year}</b></p>

      <p><b>Name:</b> ${res[0].StudentName}</p>
      <p><b>Admission No:</b> ${res[0].AdmissionNo}</p>
      <p><b>Class:</b> ${res[0].Class}</p>

      <table>
        <tr>
          <th>Subject</th>
          <th>Score</th>
          <th>Grade</th>
          <th>Remark</th>
        </tr>
        ${rows}
      </table>

      <br>
      <button class="btn secondary" onclick="window.print()">
        Download / Print PDF
      </button>
    </div>`;
  })
  .catch(()=>out.innerHTML="⚠ Error loading results");
};
</script>

</body>
</html>
